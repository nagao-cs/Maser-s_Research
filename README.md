# 修士の研究管理

### 現在の課題
+ 車と二輪の区別がついていない
    + carla.CityObjectLabel.vehiclesで車もバイクも自転車も車として取得できる(駐車車両も)
    + vehiclesでも取得できる(駐車車両は取得できない)
    + actorblueprintか、semantictagか、type_idで区別できるかも
    + carla.Actorはsemantic_tags(list[int])とtype_id(str)を属性に持つ
+ 画像の保存に時間がかかりすぎる
    + 並列処理か何か
+ 画像間の物体の位置のずれの正しい修正

### 次のステップ
+ 適応的にバージョンを変えていく -> どういうシナリオか
天候、時間、ものの量、状況に応じて、都市と田舎を交互にぐるぐる
+ どれが一番いい組み合わせなのかを見つける効率的に
+ よりよい画像を生成するには
+ 少し時間的にずれたものを組み合わせる(時間的な多様性)


## 進捗報告のフィードバック
+ 視野角だったりほかの値も妥当な値を調べてからデータセット作り直す
+ 完璧に分けてもその限界は行けるのか
+ 限界を超えるよりもNバージョンでできることを深堀
+ どういうときに修復不可能なエラーか具体的に
+ 改善するときにどの方向性で多様化すると改善できるかをわかるようになると言い
+ こういう入力が来たら修復不可能かを前段階でわかると諦められる

### フィードバック
+ 組み合わせは総当たりで -> これをやる(もっと多様にしながら)
+ 結果の出し方

課題
* 信号機とかこっち向いていない
* ぎりぎりのやつ除外すべき
+ 物体検出ならではの課題多様性の


## 関連研究
### Object detectionのアンサンブル手法（複数の物体検出モデルを組み合わせる手法
### バイアスとバリアンス
+ バイアス：予測が実際の値からどの程度離れているか
+ バリアンス：予測がどの程度分散しているか

### アンサンブル学習
https://www.d.umn.edu/~rmaclin/cs5751/notes/opitz-jair99.pdf
### バギング
+ 高バリアンスで低バイアスの弱学習器に対して使用
+ 訓練データのノイズに対してロバスト性がある
+ 訓練セットのわずかな変更で予測が大きく変わる不安定な学習アルゴリズムに効果的

予測の平均値または多数決を採用し、より精度の高い推定値を算出。
回帰の場合は、個々の分類器が予測したすべての出力値から平均値を出力(ソフト投票)。
分類の場合は、最も多数派の分類を採用(ハード投票または多数決投票)

### ブースティング
+ 低バリアンスで高バイアスの弱学習器に対して使用
+ 過学習が発生しやすくなる
+ 弱学習器を繰り返し組み合わせて、より正確な結果を予測できる強学習器を構築する

ブースティングでは、以前の分類器によって誤分類されたデータが、次の学習器の学習で頻繁に選択される。これにより、新しい分類器は、現在のアンサンブルが苦手としている例をより正確に予測できるようになる。

### スタッキング
+ 複数のモデルの出力を新しい特徴量として組み合わせ、別のモデル（メタモデル）で最終的な予測を行う。

複数のモデル（例：モデルA、モデルB、モデルC）を訓練して予測を行う。
各モデルの予測結果を、新しいデータセットとしてまとめる。
そのデータセットを使ってメタモデル（ブレンダーとも呼ばれる）を訓練し、最終的な予測を行う。
異なるモデルの結果をまとめ、さらに別のモデルで最終予測を行う。

##E BBoxの統合
### NMS
1. すべてのBBoxを信頼度順にソート
2. 最も高いBBoxと重複するBBoxを削除
3. 残りのBBoxに対して繰り返し実行

### SoftNMS
https://arxiv.org/pdf/1704.04503

### PRAE
https://arxiv.org/pdf/2105.03139
各検出モデルのBBoxの信頼度には差があるため、そのままアンサンブルすると性能低下の原因になる。各モデルの信頼度の差を統計的確率に変換することで解消する。
1. 複数の物体検出モデルを評価セットで物体検出を実行
2. 評価セットでの結果から、各BBoxが正しい確率を統計的に計算
3. テストセットで物体検出を実行
4. (2)で計算した確率を適用して、テストセットでのBBoxの信頼度を統計的確率に置き換え
5. (4)の統計的確率を重みとして複数のBBoxをNMSベースで融合
6. 複数のモデルの結果を融合したものを最終検出結果として出力

### WBF
https://arxiv.org/pdf/1910.13302
1. 各モデルからの予測を信頼度の降順にソートし、リストBを生成する
2. ボックスのクラスターと統合したボックス、それぞれのリストLとFを定義する
3. Bの各ボックスとFで一致するものがあるか調べる
4. 一致するものがあればFに対応するLのクラスターに追加
5. なけらばFとLに新しいエントリーを追加
6. 各クラスタについて、信頼度で重みづけしてボックスの平均座標を計算する
NMSでは一部のボックスが除外されるが、WBFではすべてのボックスが使用される

### データセットについて
+ https://arxiv.org/html/2503.03100v1 -> 深度カメラを使ったデータ収集について

### 興味
+ 物体検出モデルや入力画像の自由度が上がったから、モデルの多様性や画像の多様性も調べられる
+ 自分のデータセットでモデルの学習もできそう